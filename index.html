<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#c7a0f1" />
    <title>EchoVerse</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="manifest" href="manifest.json" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>
<body>
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">ðŸŒ™</button>

    <main>
        <section class="landing-hero">
            <h1 class="brand-title">EchoVerse</h1>
            <p class="tagline">People judge. We don't.<br />Let your Echo travel through the Verse.</p>
            <button class="cta-button" id="loginBtn">Login</button>
        </section>
    </main>

    <!-- Login Modal -->
    <div id="loginModal" class="modal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
            <h2 id="loginTitle">Login to EchoVerse</h2>
            <input type="text" id="username" placeholder="Username" autocomplete="username" />
            <input type="password" id="password" placeholder="Password" autocomplete="current-password" />
            <button class="cta-button" id="submitLogin">Enter</button>
            <p id="errorMsg" style="color:#ff6b6b; display:none; margin-top:10px;"></p>
        </div>
    </div>

    <script>
        // Theme setup
        const html = document.documentElement;
        const themeToggle = document.getElementById('themeToggle');
        const savedTheme = localStorage.getItem('theme') || 'light';
        html.setAttribute('data-theme', savedTheme);
        themeToggle.textContent = savedTheme === 'light' ? 'ðŸŒ™' : 'â˜€ï¸';
        themeToggle.addEventListener('click', () => {
            const current = html.getAttribute('data-theme');
            const next = current === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', next);
            themeToggle.textContent = next === 'light' ? 'ðŸŒ™' : 'â˜€ï¸';
            localStorage.setItem('theme', next);
        });

        // Modal + login
        const loginBtn = document.getElementById('loginBtn');
        const loginModal = document.getElementById('loginModal');
        const submitLogin = document.getElementById('submitLogin');
        const USER = 'UNSHREKABLE';
        const PASS = 'MAYDAYPASS';

        loginBtn.addEventListener('click', () => {
            loginModal.style.display = 'flex';
            loginModal.setAttribute('aria-hidden', 'false');
            document.getElementById('username').focus();
        });

        // Close modal by clicking outside
        loginModal.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                loginModal.style.display = 'none';
                loginModal.setAttribute('aria-hidden', 'true');
            }
        });

        // Submit login
        submitLogin.addEventListener('click', () => {
            const u = document.getElementById('username').value.trim();
            const p = document.getElementById('password').value;
            const errorMsg = document.getElementById('errorMsg');
            if (u === USER && p === PASS) {
                localStorage.setItem('echoverse_auth', 'true');
                window.location.href = 'echo.html';
            } else {
                errorMsg.textContent = 'Invalid credentials';
                errorMsg.style.display = 'block';
            }
        });

        // Enter key submits
        document.getElementById('password').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') submitLogin.click();
        });

        // Register service worker (optional for A2HS)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(() => {});
        }
    </script>
</body>
</html>
